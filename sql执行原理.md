## 数据库sql查询原理 -- 

### 第一步： 识别关键字 -->
    服务端会将sql查询语句放在一个线程当中运行，发送给mysql，到达sql后，mysql会首先判断sql语句的
    前六个字符是否是select,并且语句中不带有sql_no_cache关键字，符合条件，下一步就是查询缓存；
### 第二步： 查询缓存（mysql8.0之后取消缓存机制） -->
	缓存其实就是一张hash表，它将执行过的查询语句和结果以key-value的形式存储在内存中，key是由查询
    语句、数据库、客户端协议等生成的一个hash值，value是查询的结果；
	当然可以通过在查询语句中添加sql_no_cache关键字，或者将query_type_cache参数设置为demand绕过
    缓存；
	由于缓存具有一定的局限性，所有高版本mysql取消了缓存机制；
		局限1：sql语句一点点不同，都不会命中缓存（空格、注释等）；
		局限2：对一个 表的更新，会将所有缓存清空；
### 第三步： 解析器 -->
	缓存不命中情况下，进入解析器，解析器分两步对sql进行解析：
		解析步骤一：词法分析
		    从左往右一个字符一个字符地输入，然后根据构词规则识别单词，然后生成多个token；
		解析步骤二：语法解析
		    判断是否符合mysql的语法规则，如果不符合规则，抛出错误提示；如果语法正确，会生成一个语
            法树，送入到预处理器；
### 第四步： 预处理器 -->
     预处理器会对sql涉及的表名、列名、数据库等做匹配，看是否存在这些名字，不存在会抛出错误提示，然
     后再做权限验证，看是否具备操作权限，然后将这个语法树传递给优化器；
### 第四步： 优化器 -->
     优化器是针对语法树做优化，判断如何查询才能更快，生成一个执行计划，将执行计划交给执行器；
### 第五步： 执行器 -->
     执行器通过执行计划，一条一条的调用底层的存储引擎，逐步执行指令；
     mysql定义了一系列抽象的存储引擎API，支持插件式存储引擎架构。mysql实现了一个抽象接口层，叫做
     handler(sql/handler.h),其中定义了接口函数，比如：ha_open,ha_index_end,ha_create等等，存
     储引擎需要实现 这些接口才能被系统使用；
### 第六步： 返回结果
    最后，mysql会将查询的结果返回给客户端，如果是select类型的sql会将其缓存起来，其他类型的sql，会
    将该表涉及到的查询缓存清空（mysql8.0版本后取消缓存机制）；